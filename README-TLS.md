# V2Ray TLS ä¸€é”®éƒ¨ç½²è„šæœ¬ ğŸ”’

ğŸš€ **ä¼ä¸šçº§V2Ray + Nginx + TLSçš„å®Œæ•´è§£å†³æ–¹æ¡ˆï¼Œå…·å¤‡é«˜çº§æµé‡ä¼ªè£…åŠŸèƒ½**

## ğŸ“– ç®€ä»‹

V2Ray TLS æ˜¯ä¸€ä¸ªé«˜çº§ä»£ç†æœåŠ¡å™¨éƒ¨ç½²æ–¹æ¡ˆï¼Œä½¿ç”¨ WebSocket over TLS ä¼ è¾“åè®®ï¼Œé€šè¿‡åŸŸåå’ŒSSLè¯ä¹¦æä¾›å®‰å…¨è¿æ¥ã€‚å…·å¤‡å…ˆè¿›çš„æµé‡ä¼ªè£…æŠ€æœ¯ï¼Œæµé‡ç‰¹å¾ä¸çœŸå®HTTPSç½‘ç«™å‡ ä¹æ— æ³•åŒºåˆ†ã€‚

## âœ¨ æ ¸å¿ƒäº®ç‚¹

### ğŸ­ **é«˜çº§æµé‡ä¼ªè£…**
- âœ… **åŠ¨æ€å†…å®¹ç”Ÿæˆ** - æ ¹æ®è®¿é—®æ—¶é—´è‡ªåŠ¨åˆ‡æ¢ç½‘ç«™ç±»å‹
- âœ… **ä¸‰å¥—ä¸“ä¸šæ¨¡æ¿** - æŠ€æœ¯åšå®¢ã€ä¼ä¸šç½‘ç«™ã€ä¸ªäººä½œå“é›†
- âœ… **å®Œæ•´é™æ€èµ„æº** - CSS/JS/APIç«¯ç‚¹ä¼ªè£…
- âœ… **æœç´¢å¼•æ“ä¼˜åŒ–** - ä¸“ç”¨çˆ¬è™«é¡µé¢ï¼Œå®Œæ•´SEOé…ç½®
- âœ… **çœŸå®ç½‘ç«™è¡Œä¸º** - æ¨¡æ‹Ÿæ­£å¸¸WebæœåŠ¡å™¨å“åº”

### ğŸ” **ä¼ä¸šçº§å®‰å…¨**
- âœ… **TLS 1.2/1.3 åŠ å¯†** - æœ€æ–°çš„ä¼ è¾“å±‚å®‰å…¨åè®®
- âœ… **è‡ªåŠ¨è¯ä¹¦ç®¡ç†** - Let's Encrypt è‡ªåŠ¨ç”³è¯·å’Œç»­æœŸ
- âœ… **HTTP/2 æ”¯æŒ** - ç°ä»£Webåè®®æ”¯æŒ
- âœ… **å®‰å…¨HTTPå¤´** - HSTSã€CSPç­‰å®‰å…¨ç­–ç•¥
- âœ… **å®Œç¾å‰å‘ä¿å¯†** - PFSåŠ å¯†å¥—ä»¶

### ğŸ›¡ï¸ **åæ£€æµ‹æŠ€æœ¯**
- âœ… **æ·±åº¦æµé‡æ··æ·†** - WebSocket over TLSéšè—
- âœ… **åŸŸåä¼ªè£…** - ä½¿ç”¨çœŸå®åŸŸåå¢åŠ å¯ä¿¡åº¦
- âœ… **è¡Œä¸ºæ¨¡æ‹Ÿ** - æ¨¡æ‹ŸçœŸå®ç”¨æˆ·è®¿é—®æ¨¡å¼
- âœ… **å¤šè·¯å¾„æ”¯æŒ** - åªæœ‰ç‰¹å®šè·¯å¾„æ‰æ˜¯ä»£ç†æµé‡

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

### åŸºç¡€è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 18.04+, CentOS 8+, Debian 10+
- **å†…å­˜**: æœ€ä½ 1GBï¼Œæ¨è 2GB+ï¼ˆTLSå¤„ç†éœ€è¦æ›´å¤šå†…å­˜ï¼‰
- **ç£ç›˜**: æœ€ä½ 2GB å¯ç”¨ç©ºé—´
- **ç½‘ç»œ**: å…¬ç½‘IPåœ°å€ + åŸŸåè§£æ

### åŸŸåè¦æ±‚
- ğŸŒ **æœ‰æ•ˆåŸŸå** - å¿…é¡»æ‹¥æœ‰ä¸€ä¸ªå¯ä»¥æ§åˆ¶DNSçš„åŸŸå
- ğŸŒ **DNSè§£æ** - åŸŸåéœ€è¦æ­£ç¡®è§£æåˆ°æœåŠ¡å™¨IP
- ğŸŒ **80ç«¯å£è®¿é—®** - Let's Encryptéœ€è¦80ç«¯å£è¿›è¡ŒéªŒè¯

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å‡†å¤‡åŸŸå
ç¡®ä¿ä½ çš„åŸŸåæ­£ç¡®è§£æåˆ°æœåŠ¡å™¨ï¼š
```bash
# æ£€æŸ¥åŸŸåè§£æ
nslookup your-domain.com
dig +short your-domain.com
```

### 2. ä¸‹è½½è„šæœ¬
```bash
wget https://raw.githubusercontent.com/alleninnz/v2ray/main/deploy-v2ray-tls.sh
# æˆ–è€…
curl -O https://raw.githubusercontent.com/alleninnz/v2ray/main/deploy-v2ray-tls.sh
```

### 3. è¿è¡Œè„šæœ¬

#### ä½¿ç”¨ Let's Encrypt è¯ä¹¦ï¼ˆæ¨èï¼‰
```bash
sudo bash deploy-v2ray-tls.sh -d your-domain.com -e your-email@example.com
```

#### ä½¿ç”¨è‡ªç­¾åè¯ä¹¦ï¼ˆæµ‹è¯•ç¯å¢ƒï¼‰
```bash
sudo bash deploy-v2ray-tls.sh -d your-domain.com -c self-signed
```

#### æŸ¥çœ‹æ‰€æœ‰é€‰é¡¹
```bash
bash deploy-v2ray-tls.sh -h
```

### 4. å‚æ•°è¯´æ˜
- `-d, --domain` - åŸŸåï¼ˆå¿…éœ€ï¼‰
- `-e, --email` - Let's Encrypt é‚®ç®±åœ°å€
- `-c, --cert` - è¯ä¹¦ç±»å‹ï¼š`letsencrypt`ï¼ˆé»˜è®¤ï¼‰æˆ– `self-signed`

## ğŸ­ æµé‡ä¼ªè£…è¯¦è§£

### åŠ¨æ€å†…å®¹åˆ‡æ¢
è„šæœ¬ä¼šæ ¹æ®è®¿é—®æ—¶é—´è‡ªåŠ¨åˆ‡æ¢ä¸åŒçš„ç½‘ç«™ç±»å‹ï¼š

| æ—¶é—´æ®µ | ç½‘ç«™ç±»å‹ | æè¿° |
|--------|----------|------|
| 00:00-12:59 | ğŸ“¡ **TechInsights æŠ€æœ¯åšå®¢** | MLè¶‹åŠ¿ã€Webå¼€å‘ã€äº‘æ¶æ„æ–‡ç«  |
| 13:00-17:59 | ğŸ¢ **InnovaTech ä¼ä¸šç½‘ç«™** | äº‘è¿ç§»ã€æ•°å­—è½¬å‹ã€AIé›†æˆæœåŠ¡ |
| 18:00-23:59 | ğŸ‘¨â€ğŸ’» **Alex Chen ä¸ªäººä½œå“é›†** | å…¨æ ˆå¼€å‘è€…ã€é¡¹ç›®å±•ç¤ºã€æŠ€èƒ½ä»‹ç» |

### å®Œæ•´çš„Webç”Ÿæ€ç³»ç»Ÿ
```
https://your-domain.com/
â”œâ”€â”€ /                    # åŠ¨æ€ä¸»é¡µï¼ˆæ ¹æ®æ—¶é—´åˆ‡æ¢ï¼‰
â”œâ”€â”€ /assets/style.css    # å®Œæ•´CSSæ ·å¼è¡¨
â”œâ”€â”€ /js/main.js         # çœŸå®JavaScripté€»è¾‘
â”œâ”€â”€ /api/status         # æ¨¡æ‹ŸAPIçŠ¶æ€æ¥å£
â”œâ”€â”€ /api/health         # å¥åº·æ£€æŸ¥API
â”œâ”€â”€ /images/            # å›¾ç‰‡è·¯å¾„ï¼ˆ404å“åº”ï¼‰
â”œâ”€â”€ /favicon.ico        # ç½‘ç«™å›¾æ ‡
â”œâ”€â”€ /robots.txt         # æœç´¢å¼•æ“çˆ¬è™«æŒ‡ä»¤
â””â”€â”€ /ray                # V2Ray WebSocketè·¯å¾„ï¼ˆéšè—ï¼‰
```

### æœç´¢å¼•æ“ä¼˜åŒ–
- ğŸ” **å®Œæ•´Metaæ ‡ç­¾** - description, keywords, Open Graph
- ğŸ” **ç»“æ„åŒ–æ•°æ®** - JSON-LD ç»„ç»‡æ¶æ„æ•°æ®
- ğŸ” **Canonicalé“¾æ¥** - é˜²é‡å¤å†…å®¹
- ğŸ” **ç§»åŠ¨ç«¯é€‚é…** - å“åº”å¼è®¾è®¡
- ğŸ” **çˆ¬è™«ä¸“ç”¨é¡µé¢** - é’ˆå¯¹æœç´¢å¼•æ“ä¼˜åŒ–çš„å†…å®¹

## ğŸ“Š é…ç½®è¯¦æƒ…

### é»˜è®¤é…ç½®
- **HTTPS ç«¯å£**: 10086
- **HTTP ç«¯å£**: 80ï¼ˆé‡å®šå‘åˆ°HTTPSï¼‰
- **V2Ray å†…éƒ¨ç«¯å£**: 8080
- **WebSocket è·¯å¾„**: `/ray`
- **ä¼ è¾“åè®®**: WebSocket over TLS

### ç›®å½•ç»“æ„
```
/opt/v2ray-tls/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ config.json              # V2Ray é…ç½®æ–‡ä»¶
â”œâ”€â”€ nginx/
â”‚   â””â”€â”€ nginx.conf               # Nginx é…ç½®æ–‡ä»¶
â”œâ”€â”€ certs/                       # SSLè¯ä¹¦ç›®å½•
â”‚   â”œâ”€â”€ live/your-domain.com/    # Let's Encrypt è¯ä¹¦
â”‚   â””â”€â”€ www/                     # ACMEéªŒè¯ç›®å½•
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ renew-cert.sh           # è¯ä¹¦ç»­æœŸè„šæœ¬
â”œâ”€â”€ logs/                        # æ—¥å¿—ç›®å½•
â”œâ”€â”€ docker-compose.yml           # Docker Compose é…ç½®
â””â”€â”€ connection-info.txt          # è¿æ¥ä¿¡æ¯
```

### è¯ä¹¦ç®¡ç†
- **è‡ªåŠ¨ç»­æœŸ** - æ¯æœˆè‡ªåŠ¨æ£€æŸ¥å’Œç»­æœŸè¯ä¹¦
- **å¤±è´¥å›é€€** - Let's Encryptå¤±è´¥æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°è‡ªç­¾å
- **Cronä»»åŠ¡** - è‡ªåŠ¨æ·»åŠ åˆ°ç³»ç»Ÿå®šæ—¶ä»»åŠ¡

## ğŸ“± å®¢æˆ·ç«¯é…ç½®

### Shadowrocket
```
ç±»å‹: VMess
æœåŠ¡å™¨: your-domain.com
ç«¯å£: 10086
ç”¨æˆ·ID: [ç”Ÿæˆçš„UUID]
é¢å¤–ID: 0
åŠ å¯†æ–¹å¼: auto
ä¼ è¾“åè®®: WebSocket (ws)
è·¯å¾„: /ray
Host: your-domain.com
TLS: å¼€å¯
SNI: your-domain.com
å…è®¸ä¸å®‰å…¨: å…³é—­ï¼ˆLet's Encryptï¼‰/ å¼€å¯ï¼ˆè‡ªç­¾åï¼‰
```

### V2rayN
```
åœ°å€: your-domain.com
ç«¯å£: 10086
ç”¨æˆ·ID: [ç”Ÿæˆçš„UUID]
é¢å¤–ID: 0
åŠ å¯†æ–¹å¼: auto
ä¼ è¾“åè®®: ws
è·¯å¾„: /ray
ä¼ è¾“å±‚å®‰å…¨: tls
SNI: your-domain.com
```

### Clash
```yaml
proxies:
  - name: "V2Ray-TLS"
    type: vmess
    server: your-domain.com
    port: 10086
    uuid: [ç”Ÿæˆçš„UUID]
    alterId: 0
    cipher: auto
    network: ws
    tls: true
    servername: your-domain.com
    ws-opts:
      path: /ray
      headers:
        Host: your-domain.com
```

### VMess åˆ†äº«é“¾æ¥
è„šæœ¬ä¼šè‡ªåŠ¨ç”Ÿæˆ VMess åˆ†äº«é“¾æ¥ï¼Œå¯ç›´æ¥å¯¼å…¥å®¢æˆ·ç«¯ï¼š
```
vmess://[base64ç¼–ç çš„é…ç½®ä¿¡æ¯]
```

## ğŸ”§ ç®¡ç†å‘½ä»¤

### åŸºç¡€ç®¡ç†
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
cd /opt/v2ray-tls && docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
cd /opt/v2ray-tls && docker-compose logs -f

# é‡å¯æœåŠ¡
cd /opt/v2ray-tls && docker-compose restart

# åœæ­¢æœåŠ¡
cd /opt/v2ray-tls && docker-compose down

# æ›´æ–°æœåŠ¡
cd /opt/v2ray-tls && docker-compose pull && docker-compose up -d
```

### è¯ä¹¦ç®¡ç†
```bash
# æ‰‹åŠ¨ç»­æœŸè¯ä¹¦
/opt/v2ray-tls/scripts/renew-cert.sh

# æŸ¥çœ‹è¯ä¹¦ä¿¡æ¯
openssl x509 -in /opt/v2ray-tls/certs/live/your-domain.com/fullchain.pem -text -noout

# æµ‹è¯•è¯ä¹¦æœ‰æ•ˆæ€§
openssl s_client -connect your-domain.com:10086 -servername your-domain.com
```

### ç›‘æ§å’Œè°ƒè¯•
```bash
# æµ‹è¯•HTTPSè¿æ¥
curl -k https://your-domain.com:10086/health

# æŸ¥çœ‹Nginxè®¿é—®æ—¥å¿—
tail -f /opt/v2ray-tls/logs/access.log

# æ£€æŸ¥è¯ä¹¦çŠ¶æ€
curl -I https://your-domain.com:10086
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜è§£å†³

#### 1. åŸŸåè§£æé—®é¢˜
```bash
# æ£€æŸ¥åŸŸåè§£æ
dig +short your-domain.com

# æ£€æŸ¥ä»æœåŠ¡å™¨æ˜¯å¦èƒ½è®¿é—®
curl -I http://your-domain.com
```

#### 2. Let's Encrypt è¯ä¹¦ç”³è¯·å¤±è´¥
- âœ… ç¡®ä¿åŸŸåæ­£ç¡®è§£æåˆ°æœåŠ¡å™¨IP
- âœ… æ£€æŸ¥80ç«¯å£æ˜¯å¦è¢«å ç”¨
- âœ… éªŒè¯é‚®ç®±åœ°å€æ ¼å¼æ­£ç¡®
- âœ… æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦å…è®¸80ç«¯å£

```bash
# æ‰‹åŠ¨æµ‹è¯•80ç«¯å£
python3 -m http.server 80
```

#### 3. SSLè¯ä¹¦éªŒè¯å¤±è´¥
```bash
# ä½¿ç”¨è‡ªç­¾åè¯ä¹¦é‡æ–°éƒ¨ç½²
sudo bash deploy-v2ray-tls.sh -d your-domain.com -c self-signed
```

#### 4. æœåŠ¡è¿æ¥é—®é¢˜
```bash
# æ£€æŸ¥ç«¯å£ç›‘å¬
netstat -tlnp | grep 10086

# æµ‹è¯•æœ¬åœ°è¿æ¥
curl -k https://localhost:10086/health

# æ£€æŸ¥é˜²ç«å¢™è§„åˆ™
sudo ufw status
sudo firewall-cmd --list-ports
```

#### 5. è¯ä¹¦è¿‡æœŸ
```bash
# æ£€æŸ¥è¯ä¹¦æœ‰æ•ˆæœŸ
openssl x509 -in /opt/v2ray-tls/certs/live/your-domain.com/fullchain.pem -enddate -noout

# å¼ºåˆ¶ç»­æœŸ
/opt/v2ray-tls/scripts/renew-cert.sh
```

### æ€§èƒ½ä¼˜åŒ–

#### 1. ç³»ç»Ÿä¼˜åŒ–
```bash
# ä¼˜åŒ–å†…æ ¸å‚æ•°
echo 'net.core.default_qdisc=fq' >> /etc/sysctl.conf
echo 'net.ipv4.tcp_congestion_control=bbr' >> /etc/sysctl.conf
sysctl -p
```

#### 2. Dockerä¼˜åŒ–
```bash
# æ¸…ç†æœªä½¿ç”¨çš„Dockerèµ„æº
docker system prune -a

# ç›‘æ§å®¹å™¨èµ„æºä½¿ç”¨
docker stats
```

## ğŸ” å®‰å…¨æœ€ä½³å®è·µ

### 1. è¯ä¹¦å®‰å…¨
- ğŸ”’ ä½¿ç”¨ Let's Encrypt è¯ä¹¦è€Œéè‡ªç­¾å
- ğŸ”’ å®šæœŸæ£€æŸ¥è¯ä¹¦æœ‰æ•ˆæœŸ
- ğŸ”’ å¯ç”¨è¯ä¹¦é€æ˜åº¦ç›‘æ§

### 2. è®¿é—®æ§åˆ¶
- ğŸ›¡ï¸ é…ç½®å¼ºå¯†ç å’Œå¤æ‚UUID
- ğŸ›¡ï¸ é™åˆ¶ç™»å½•å°è¯•æ¬¡æ•°
- ğŸ›¡ï¸ ç›‘æ§å¼‚å¸¸è®¿é—®æ¨¡å¼

### 3. ç½‘ç»œå®‰å…¨
- ğŸŒ åªå¼€æ”¾å¿…è¦çš„ç«¯å£ï¼ˆ80, 443, 10086ï¼‰
- ğŸŒ ä½¿ç”¨äº‘å‚å•†çš„å®‰å…¨ç»„åŠŸèƒ½
- ğŸŒ å¯ç”¨DDoSé˜²æŠ¤

### 4. æ—¥å¿—ç›‘æ§
```bash
# è®¾ç½®æ—¥å¿—è½®è½¬
echo '/opt/v2ray-tls/logs/*.log {
    daily
    missingok
    rotate 7
    compress
    notifempty
    create 0644 root root
}' > /etc/logrotate.d/v2ray-tls
```

## ğŸ¯ é«˜çº§åŠŸèƒ½

### 1. å¤šåŸŸåæ”¯æŒ
å¯ä»¥ä¿®æ”¹é…ç½®æ”¯æŒå¤šä¸ªåŸŸåï¼š
```nginx
server_name domain1.com domain2.com *.example.com;
```

### 2. è´Ÿè½½å‡è¡¡
```yaml
services:
  v2ray-1:
    # V2Rayå®ä¾‹1é…ç½®
  v2ray-2:
    # V2Rayå®ä¾‹2é…ç½®
```

### 3. ç›‘æ§é›†æˆ
```yaml
services:
  prometheus:
    # ç›‘æ§é…ç½®
  grafana:
    # å¯è§†åŒ–é…ç½®
```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### é¢„æœŸæ€§èƒ½
- **å¹¶å‘è¿æ¥**: 1000+ åŒæ—¶è¿æ¥
- **å¸¦å®½**: æ”¯æŒåƒå…†ç½‘ç»œ
- **å»¶è¿Ÿ**: é¢å¤–å»¶è¿Ÿ < 5ms
- **CPUä½¿ç”¨**: < 10%ï¼ˆé—²æ—¶ï¼‰
- **å†…å­˜ä½¿ç”¨**: < 512MB

### åŸºå‡†æµ‹è¯•
```bash
# æµ‹è¯•å»¶è¿Ÿ
ping your-domain.com

# æµ‹è¯•å¸¦å®½
speedtest-cli

# å‹åŠ›æµ‹è¯•
ab -n 1000 -c 10 https://your-domain.com:10086/
```

## ğŸŒŸ æ›´æ–°æ—¥å¿—

### v2.0.0ï¼ˆå½“å‰ç‰ˆæœ¬ï¼‰
- âœ… æ–°å¢åŠ¨æ€å†…å®¹ç”Ÿæˆ
- âœ… æ–°å¢ä¸‰å¥—ä¸“ä¸šç½‘ç«™æ¨¡æ¿
- âœ… æ–°å¢æœç´¢å¼•æ“ä¼˜åŒ–
- âœ… æ–°å¢å®Œæ•´é™æ€èµ„æºä¼ªè£…
- âœ… ä¼˜åŒ–TLSé…ç½®å’Œå®‰å…¨æ€§

### v1.0.0
- âœ… åŸºç¡€TLSæ”¯æŒ
- âœ… Let's Encryptè‡ªåŠ¨è¯ä¹¦
- âœ… Dockerå®¹å™¨åŒ–éƒ¨ç½²

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### åœ¨çº¿èµ„æº
- ğŸ“– [é¡¹ç›®æ–‡æ¡£](https://github.com/alleninnz/v2ray)
- ğŸ“– [V2Rayå®˜æ–¹æ–‡æ¡£](https://www.v2fly.org/)
- ğŸ“– [Let's Encryptæ–‡æ¡£](https://letsencrypt.org/docs/)

### ç¤¾åŒºæ”¯æŒ
- ğŸ’¬ [GitHub Issues](https://github.com/alleninnz/v2ray/issues)
- ğŸ’¬ [è®¨è®ºåŒº](https://github.com/alleninnz/v2ray/discussions)

## âš ï¸ é‡è¦å£°æ˜

1. **åˆæ³•ä½¿ç”¨**: è¯·ç¡®ä¿åœ¨å½“åœ°æ³•å¾‹æ³•è§„å…è®¸çš„èŒƒå›´å†…ä½¿ç”¨
2. **éšç§ä¿æŠ¤**: ä¸è®°å½•ç”¨æˆ·è®¿é—®æ•°æ®ï¼Œä¿æŠ¤ç”¨æˆ·éšç§
3. **æŠ€æœ¯ç”¨é€”**: æœ¬é¡¹ç›®ä»…ä¾›æŠ€æœ¯å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨
4. **è´£ä»»å£°æ˜**: ä½¿ç”¨è€…éœ€è¦å¯¹è‡ªå·±çš„è¡Œä¸ºè´Ÿè´£

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

---

**ğŸ”’ å®‰å…¨è¿æ¥ï¼ŒğŸ­ å®Œç¾ä¼ªè£…ï¼Œâš¡ æé€Ÿä½“éªŒ**